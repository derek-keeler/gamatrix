# Flutter Gamatrix

A Flutter-based alternative UX for Gamatrix that provides the same functionality as the Python web application but built with Dart and Flutter.

## Overview

This Flutter application reads from the Gamatrix data store JSON files (created by the Python application) and provides a mobile-friendly interface for comparing game libraries between users.

## Features

- **Data Store Integration**: Reads and processes Gamatrix data store JSON files
- **User Selection**: Choose which users to compare game libraries
- **Game List View**: Display games in a detailed list format with installation status
- **Game Grid View**: Show games in a grid format with ownership indicators
- **Advanced Filtering**: 
  - Filter by installed games only
  - Include/exclude single-player games
  - Exclude specific platforms
  - Show only exclusively owned games
- **Search Functionality**: Search games by title or platform
- **Random Game Selection**: Pick a random game from filtered results
- **Dark Theme**: Matches the original Gamatrix web UI color scheme

## Prerequisites

- Flutter SDK (>=3.0.0)
- Dart SDK (>=3.0.0)
- A Gamatrix data store JSON file (generated by the Python application)

## Installation

1. **Install Flutter**: Follow the official Flutter installation guide for your platform:
   - [Flutter Installation Guide](https://docs.flutter.dev/get-started/install)

2. **Clone the repository** (if not already done):
   ```bash
   git clone https://github.com/derek-keeler/gamatrix.git
   cd gamatrix/flutter_gamatrix
   ```

3. **Install dependencies**:
   ```bash
   flutter pub get
   ```

4. **Run the application**:
   ```bash
   flutter run
   ```

## Usage

### Data Store File

The Flutter app requires a Gamatrix data store JSON file to function. This file is created by the Python Gamatrix application when processing GOG Galaxy database files.

#### Getting a Data Store File

1. **From existing Python Gamatrix installation**: 
   - Use the Python Gamatrix application to process GOG Galaxy databases
   - The data store file will be created automatically
   - Locate the JSON file (typically named with a `.json` extension)

2. **Sample data for testing**:
   - The app will create a sample data store file on first run for demonstration purposes
   - This allows you to test the Flutter app without needing the Python version

#### Loading Data Store File

1. **Automatic loading**: The app will attempt to load the last used data store file on startup
2. **Manual selection**: Use the folder icon in the app bar to select a new data store file
3. **File format**: The file must be a valid JSON file with the Gamatrix data store structure

### Interface Overview

#### Home Screen
- **Data Store Info**: Shows information about the currently loaded data store
- **View Mode**: Choose between Game List or Game Grid view
- **User Selection**: Select which users to compare (checkboxes)
- **Platform Exclusions**: Exclude specific gaming platforms from results
- **Filter Options**: Various filters to refine game results
- **"Giv'er" Button**: Execute the comparison with selected options

#### Game List View
- Shows games in a detailed card format
- Each card displays:
  - Game title and platforms
  - Multiplayer status and max players
  - Installation status across selected users
  - Expandable details with ownership information
- Search functionality to filter games
- Color coding for single-player games (grayed out)

#### Game Grid View
- Displays games in a compact grid format
- Shows ownership matrix for selected users
- Color-coded cells:
  - **Green**: User owns the game
  - **Red**: User doesn't own the game
  - **Check mark**: Game is installed
  - **Empty circle**: Game is owned but not installed

### Filters and Options

- **Exclusively owned**: Show only games owned by selected users and not owned by unselected users
- **Installed only**: Show only games that are installed by all selected users
- **Include single-player**: Include single-player games in results (excluded by default)
- **Pick a random game**: Select one random game from the filtered results
- **Platform exclusions**: Exclude games from specific platforms (Steam, GOG, Epic, etc.)

## Project Structure

```
flutter_gamatrix/
├── lib/
│   ├── main.dart                 # App entry point
│   ├── models/
│   │   └── data_models.dart      # Data structures (GameData, UserData, DataStore)
│   ├── services/
│   │   └── data_store_service.dart # Data store management and filtering
│   ├── screens/
│   │   ├── home_screen.dart      # Main interface screen
│   │   ├── game_list_screen.dart # Game list view
│   │   └── game_grid_screen.dart # Game grid view
│   └── widgets/
│       └── game_card.dart        # Reusable game card widget
├── assets/
│   ├── images/                   # Image assets
│   └── icons/                    # Icon assets
├── test/                         # Test files
├── pubspec.yaml                  # Flutter project configuration
└── README.md                     # This file
```

## Data Store Format

The Flutter app expects JSON files with the following structure:

```json
{
  "version": "1.0",
  "last_updated": "2024-01-01T12:00:00",
  "users": {
    "12345": {
      "user_id": 12345,
      "username": "Alice",
      "db_filename": "alice-galaxy-2.0.db",
      "db_mtime": "2024-01-01 12:00:00",
      "total_games": 150,
      "installed_games": 25
    }
  },
  "games": {
    "witcher3_steam": {
      "release_key": "witcher3_steam",
      "title": "The Witcher 3: Wild Hunt",
      "slug": "witcher-3-wild-hunt",
      "platforms": ["steam"],
      "owners": [12345, 67890],
      "installed": [12345],
      "igdb_key": "witcher3",
      "multiplayer": false,
      "max_players": 1,
      "comment": null,
      "url": null
    }
  }
}
```

## Building for Release

### Android
```bash
flutter build apk --release
```

### iOS
```bash
flutter build ios --release
```

### Web
```bash
flutter build web --release
```

### Desktop (Windows/macOS/Linux)
```bash
flutter build windows --release  # Windows
flutter build macos --release    # macOS
flutter build linux --release    # Linux
```

## Development

### Running Tests
```bash
flutter test
```

### Code Analysis
```bash
flutter analyze
```

### Formatting
```bash
dart format .
```

## Troubleshooting

### Common Issues

1. **Data store file not loading**:
   - Ensure the file is valid JSON
   - Check file permissions
   - Verify the file structure matches the expected format

2. **No games showing**:
   - Check that users are selected
   - Verify filter settings aren't too restrictive
   - Ensure the data store contains games for the selected users

3. **App crashes on startup**:
   - Clear app data/cache
   - Ensure Flutter SDK is up to date
   - Check for any missing dependencies

### Getting Help

For issues specific to the Flutter app:
1. Check the Flutter console output for error messages
2. Ensure all dependencies are properly installed
3. Verify the data store file format is correct

## License

This project follows the same license as the main Gamatrix project.